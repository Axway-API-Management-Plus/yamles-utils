---
rules:
  "cassandra_settings":
    name: Cassandra Nodes
    description: Check Cassandra nodes
    fileType: CassandraSettings
    filePatterns:
      - '/Server Settings/Cassandra Settings.yaml'
    assertions:
      - path: '$.children[0].fields.host'
        type: regex
        param: '^\$\{env\..+\}'
        message: Cassandra nodes must be configured via envSettings.properties
      - path: '$.children[1].fields.host'
        type: regex
        param: '^\$\{env\..+\}'
        message: Cassandra nodes must be configured via envSettings.properties
      - path: '$.children[2].fields.host'
        type: regex
        param: '^\$\{env\..+\}'
        message: Cassandra nodes must be configured via envSettings.properties
      - path: '$.fields.replication'
        type: environmentalized
      - path: '$.fields.replicationStrategy'
        type: environmentalized
      - path: '$.fields.throttlingReplication'
        type: environmentalized
      - path: '$.fields.throttlingReplication'
        type: environmentalized
      - path: '$.fields.throttlingReplicationStrategy'
        type: environmentalized
      - path: '$.fields.throttlingReadConsistencyLevel'
        type: environmentalized
      - path: '$.fields.throttlingWriteConsistencyLevel'
        type: environmentalized
  "kps_data_source":
    name: KPS Data Source
    description: Check data source for KPS tables
    fileType: KPSCassandraDataSource
    filePatterns:
      - '/Environment Configuration/Key Property Stores/.*/.+\.yaml'
    assertions:
      - path: '$.fields.readConsistencyLevel'
        type: environmentalized
      - path: '$.fields.writeConsistencyLevel'
        type: environmentalized
...
